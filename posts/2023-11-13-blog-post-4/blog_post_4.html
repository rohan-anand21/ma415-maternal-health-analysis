<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Aiganysh Ulanova, Jin Kyu Cho, Rohan Anand, Seokhoon Shin, Tianyu Wu">
<meta name="dcterms.date" content="2023-11-06">

<title>Group_14 Final Project - Preliminary Data Visualization and Modeling</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Group_14 Final Project</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About Our Team</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../big_picture.html">
 <span class="menu-text">America’s Maternal Health is Headed in the Wrong Direction</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../analysis.html">
 <span class="menu-text">Analysis: Does Smoking Affect Infant Health Outcomes?</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../data.html">
 <span class="menu-text">Data Collection and Cleaning</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Blog Post 4</h1>
            <p class="subtitle lead">Data Visualization and Modeling</p>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Aiganysh Ulanova, Jin Kyu Cho, Rohan Anand, Seokhoon Shin, Tianyu Wu </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">November 6, 2023</p>
      </div>
    </div>
    
      <div>
      <div class="quarto-title-meta-heading">Modified</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">November 6, 2023</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p>We have chosen 1 table, 1 plot and 1 statistical model for our exploratory data analysis.</p>
<ol type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table) </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.2     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.3     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::between()     masks data.table::between()
✖ dplyr::filter()      masks stats::filter()
✖ dplyr::first()       masks data.table::first()
✖ lubridate::hour()    masks data.table::hour()
✖ lubridate::isoweek() masks data.table::isoweek()
✖ dplyr::lag()         masks stats::lag()
✖ dplyr::last()        masks data.table::last()
✖ lubridate::mday()    masks data.table::mday()
✖ lubridate::minute()  masks data.table::minute()
✖ lubridate::month()   masks data.table::month()
✖ lubridate::quarter() masks data.table::quarter()
✖ lubridate::second()  masks data.table::second()
✖ purrr::transpose()   masks data.table::transpose()
✖ lubridate::wday()    masks data.table::wday()
✖ lubridate::week()    masks data.table::week()
✖ lubridate::yday()    masks data.table::yday()
✖ lubridate::year()    masks data.table::year()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>natality_data_cleaned <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"dataset-ignore/natality_data_cleaned.csv"</span>)); <span class="fu">setDT</span>(natality_data_cleaned) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 100000 Columns: 170
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (54): wic, cig_rec, rf_pdiab, rf_gdiab, rf_phype, rf_ghype, rf_ehype, r...
dbl (116): dob_yy, dob_mm, dob_tt, dob_wk, bfacil, f_facility, bfacil3, mage...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relabel mrace31 </span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>race_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"White (only)"</span>, <span class="st">"Black (only)"</span>, <span class="st">"AIAN (only)"</span>, <span class="st">"Asian (only)"</span>, <span class="st">"NHOPI (only)"</span>, <span class="st">"Black and White"</span>, <span class="st">"Black and AIAN"</span>, <span class="st">"Black and Asian"</span>, <span class="st">"Black and NHOPI"</span>, <span class="st">"AIAN and White"</span>, <span class="st">"AIAN and Asian"</span>, <span class="st">"AIAN and NHOPI"</span>, <span class="st">"Asian and White"</span>, <span class="st">"Asian and NHOPI"</span>, <span class="st">"NHOPI and White"</span>, <span class="st">"Black, AIAN, and White"</span>, <span class="st">"Black, AIAN, and Asian"</span>, <span class="st">"Black, AIAN, and NHOPI"</span>, <span class="st">"Black, Asian, and White"</span>, <span class="st">"Black, Asian, and NHOPI"</span>, <span class="st">"Black, NHOPI, and White"</span>, <span class="st">"AIAN, Asian, and White"</span>, <span class="st">"AIAN, NHOPI, and White"</span>, <span class="st">"AIAN, Asian, and NHOPI"</span>, <span class="st">"Asian, NHOPI, and White"</span>, <span class="st">"Black, AIAN, Asian, and White"</span>, <span class="st">"Black, AIAN, Asian, and NHOPI"</span>, <span class="st">"Black, AIAN, NHOPI, and White"</span>, <span class="st">"Black, Asian, NHOPI, and White"</span>, <span class="st">"AIAN, Asian, NHOPI, and White"</span>) </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>natality_data_cleaned[, mrace31 <span class="sc">:</span><span class="er">=</span> <span class="fu">factor</span>(mrace31, <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>, <span class="at">labels =</span> race_labels)] </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>natality_data_cleaned <span class="ot">&lt;-</span> natality_data_cleaned[<span class="sc">!</span><span class="fu">is.na</span>(mrace31) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(mager) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(dob_yy) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(dob_wk)] </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>avg_age_by_year_week <span class="ot">&lt;-</span> natality_data_cleaned[, .(<span class="at">average_age =</span> <span class="fu">mean</span>(mager, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)), by <span class="ot">=</span> .(dob_yy, dob_wk)] </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjust the code for counting occurrences of each race category combination </span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>race_counts_by_year_week <span class="ot">&lt;-</span> natality_data_cleaned[, .N, by <span class="ot">=</span> .(dob_yy, dob_wk, mrace31)]; race_counts_by_year_week <span class="ot">&lt;-</span> <span class="fu">dcast</span>(race_counts_by_year_week, dob_yy <span class="sc">+</span> dob_wk <span class="sc">~</span> mrace31, <span class="at">value.var =</span> <span class="st">"N"</span>, <span class="at">fill =</span> <span class="dv">0</span>) </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the two tables </span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>relationship_table <span class="ot">&lt;-</span> <span class="fu">merge</span>(avg_age_by_year_week, race_counts_by_year_week, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"dob_yy"</span>, <span class="st">"dob_wk"</span>), <span class="at">all =</span> <span class="cn">TRUE</span>) </span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co"># View the table </span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(relationship_table)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   dob_yy dob_wk average_age White (only) Black (only) AIAN (only) Asian (only)
1:   2021      1    27.47972         4770         1901         251          217
2:   2021      2    27.89711        11588         3656         335          366
3:   2021      3    27.69921        12469         3904         367          392
4:   2021      4    27.68055        12171         3849         394          392
5:   2021      5    27.70826        12058         3839         356          366
6:   2021      6    27.80625        10334         3423         374          317
   NHOPI (only) Black and White Black and AIAN Black and Asian Black and NHOPI
1:          103              91              4               4               3
2:          154             197             10               4               3
3:          155             211             11               7               2
4:          151             146             16               8               2
5:          144             196              9               9               2
6:          157             144             10               7               2
   AIAN and White AIAN and Asian AIAN and NHOPI Asian and White Asian and NHOPI
1:            107              4              2              31               6
2:            157              2              0              61               6
3:            150              3              1              65              10
4:            134              5              0              56               6
5:            143              4              3              62              11
6:            143              3              2              51               1
   NHOPI and White Black, AIAN, and White Black, AIAN, and Asian
1:               5                     12                      0
2:               6                      4                      0
3:              13                     12                      1
4:               6                     10                      1
5:              11                      6                      1
6:               9                      9                      0
   Black, AIAN, and NHOPI Black, Asian, and White Black, Asian, and NHOPI
1:                      0                       3                       0
2:                      0                       5                       0
3:                      0                       4                       0
4:                      0                       4                       1
5:                      0                       2                       0
6:                      0                       1                       0
   Black, NHOPI, and White AIAN, Asian, and White AIAN, NHOPI, and White
1:                       0                      3                      0
2:                       0                      1                      1
3:                       1                      4                      3
4:                       1                      4                      2
5:                       0                      2                      1
6:                       0                      6                      0
   AIAN, Asian, and NHOPI Asian, NHOPI, and White Black, AIAN, Asian, and White
1:                      0                       2                             0
2:                      1                       2                             1
3:                      0                       6                             1
4:                      0                       4                             0
5:                      0                       2                             1
6:                      1                       8                             2
   Black, AIAN, NHOPI, and White Black, Asian, NHOPI, and White
1:                             1                              0
2:                             1                              0
3:                             0                              0
4:                             0                              1
5:                             0                              1
6:                             0                              0
   AIAN, Asian, NHOPI, and White
1:                             1
2:                             0
3:                             1
4:                             0
5:                             2
6:                             0</code></pre>
</div>
</div>
<p>For the first table, we have chosen the ‘average_age’ across years and weeks (‘dob_yy’ and ‘dob_wk’) that could reveal seasonal patterns in maternal age (‘mrace31’). Moreover, it breaks down the numbers by race and ethnicity, indicating the number of births for different racial and ethnic combinations (White, Black, AIAN(American Indian or Alaska Native), Asian, NHPI(Native Hawaiian or other Pacific Islander), and combinations thereof). The average age of individuals seems around 29 for all entries and does not change much. Furthermore, the numerical values are highest for the ‘White (only)’ category and lowest for the combination of ‘Black’, ‘AIAN’, ‘Asian’, and ‘NHOPI’.</p>
<ol start="2" type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary libraries </span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2) </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr) </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr) </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the dataset </span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">'dataset-ignore'</span>,<span class="st">'natality_data_cleaned.csv'</span>)) </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out unknown race and unknown smoking status </span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>filtered_data_new <span class="ot">&lt;-</span> data[data<span class="sc">$</span>mrace15 <span class="sc">!=</span> <span class="dv">15</span> <span class="sc">&amp;</span> data<span class="sc">$</span>cig0_r <span class="sc">!=</span> <span class="dv">6</span>, ] </span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a cross-tabulation of mother's race and smoking before pregnancy </span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>race_smoking_crosstab <span class="ot">&lt;-</span> <span class="fu">table</span>(filtered_data_new<span class="sc">$</span>mrace15, filtered_data_new<span class="sc">$</span>cig0_r) </span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>race_smoking_crosstab <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(race_smoking_crosstab, <span class="dv">1</span>) </span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize by row </span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Converting the table to a dataframe for ggplot </span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>df_new <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(race_smoking_crosstab) </span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_new) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Race'</span>, <span class="st">'Smoking'</span>, <span class="st">'Proportion'</span>) </span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Renaming races and smoking categories for better readability </span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>df_new<span class="sc">$</span>Race <span class="ot">&lt;-</span> <span class="fu">factor</span>(df_new<span class="sc">$</span>Race, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">14</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">'White'</span>, <span class="st">'Black'</span>, <span class="st">'AIAN'</span>, <span class="st">'Asian Indian'</span>, <span class="st">'Chinese'</span>, <span class="st">'Filipino'</span>, <span class="st">'Japanese'</span>, <span class="st">'Korean'</span>, <span class="st">'Vietnamese'</span>, <span class="st">'Other Asian'</span>,                               <span class="st">'Hawaiian'</span>, <span class="st">'Guamanian'</span>, <span class="st">'Samoan'</span>, <span class="st">'Other pacific Islander'</span>)) </span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>df_new<span class="sc">$</span>Smoking <span class="ot">&lt;-</span> <span class="fu">factor</span>(df_new<span class="sc">$</span>Smoking, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">'Nonsmoker'</span>, <span class="st">'1-5 cigarettes'</span>, <span class="st">'6-10 cigarettes'</span>, <span class="st">'11-20 cigarettes'</span>, <span class="st">'21-40 cigarettes'</span>, <span class="st">'41 or more cigarettes'</span>)) </span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the grouped bar chart </span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_new, <span class="fu">aes</span>(<span class="at">fill=</span>Smoking, <span class="at">y=</span>Proportion, <span class="at">x=</span>Race)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">position=</span><span class="st">"fill"</span>, <span class="at">stat=</span><span class="st">"identity"</span>) <span class="sc">+</span>     <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Mother’s Race"</span>, <span class="at">y =</span> <span class="st">"Proportion of Mothers"</span>, <span class="at">fill =</span> <span class="st">"Cigarettes Before Pregnancy"</span>, <span class="at">title =</span> <span class="st">"Cigarette Consumption Before Pregnancy by Mother’s Race"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="blog_post_4_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We chose the variable “cig0_r”, which represents cigarette consumption before pregnancy, and the variable “mrace15” which represents the mother’s race, to conduct the exploratory data analysis. We created a bar chart to see if is there a relationship between smoking habits before pregnancy and different races of mothers. The bar chart above displays the proportions of smokers among mothers before pregnancy vs.&nbsp;various races of mothers. We can see that 1. AIAN mothers have the highest proportion of smokers before pregnancy. Asian Indian, Chinese, Filipino, and Vietnamese mothers have the lowest proportion of smokers before pregnancy. 2. AIAN mothers have the highest proportion of 1-5 cigarettes and 41 or more cigarettes consumed per day before pregnancy among all races. Hawaiian mothers have the highest proportion of 6-10 cigarette consumption per day before pregnancy among all races. So there is a correlation between race and consumption of cigarettes before pregnancy.</p>
<ol start="3" type="1">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>nat <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"dataset-ignore/natality_data_cleaned.csv"</span>), <span class="at">show_col_types =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(precare <span class="sc">!=</span> <span class="dv">99</span>) <span class="sc">|&gt;</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(combgest <span class="sc">!=</span> <span class="dv">99</span>) <span class="sc">|&gt;</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(previs <span class="sc">!=</span> <span class="dv">99</span>) <span class="sc">|&gt;</span> </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ab_nicu <span class="sc">!=</span> <span class="st">'U'</span>) <span class="sc">|&gt;</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ab_nicu =</span> <span class="fu">as.integer</span>(<span class="fu">ifelse</span>(ab_nicu <span class="sc">==</span> <span class="st">'Y'</span>, <span class="dv">1</span>, <span class="fu">ifelse</span>(ab_nicu <span class="sc">==</span> <span class="st">'N'</span>, <span class="dv">0</span>, ab_nicu)))) <span class="sc">|&gt;</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mm_aicu <span class="sc">!=</span> <span class="st">'U'</span>) <span class="sc">|&gt;</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mm_aicu =</span> <span class="fu">as.integer</span>(<span class="fu">ifelse</span>(mm_aicu <span class="sc">==</span> <span class="st">'Y'</span>, <span class="dv">1</span>, <span class="fu">ifelse</span>(mm_aicu <span class="sc">==</span> <span class="st">'N'</span>, <span class="dv">0</span>, mm_aicu)))) <span class="sc">|&gt;</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gestrec3 <span class="sc">!=</span> <span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gestrec3 =</span> gestrec3 <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>birth_weight <span class="ot">=</span> nat<span class="sc">$</span>dbwt</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>mager <span class="ot">=</span> nat<span class="sc">$</span>mager</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>prenatal_care_start <span class="ot">=</span> nat<span class="sc">$</span>precare</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>mrace <span class="ot">=</span> nat<span class="sc">$</span>mrace31</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>smoking_status <span class="ot">=</span> nat<span class="sc">$</span>cig0_r</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="co">#Linear</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(birth_weight <span class="sc">~</span> prenatal_care_start <span class="sc">+</span> mrace <span class="sc">+</span> smoking_status, <span class="at">data =</span> nat)</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting observed vs. predicted birth weight</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>predicted_birth_weight <span class="ot">&lt;-</span> <span class="fu">predict</span>(model1)</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(birth_weight, predicted_birth_weight, <span class="at">xlab =</span> <span class="st">"Observed Birth Weight"</span>, <span class="at">ylab =</span> <span class="st">"Predicted Birth Weight"</span>, <span class="at">main =</span> <span class="st">"Observed vs Predicted Birth Weight"</span>)</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="blog_post_4_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The statistical model we choose is linear regression. We did linear regression to predict birth weight based on a number of variables such as mothers age, start of prenatal care, race and whether they smoked cigarettes before pregnancy. We fitted the model and plotted a scatter plot of observed by predicted. There is significant variation since the all of the points are not aggregated around the red line, indicating that transformations, such as log or other, should be made on the variables. However, a non-substantial amount of points aggregate around the line, indicating that the variables used in the predictor are capable of producing accurate predictions. Therefore, there is a slight correlation between birth weight and smoking status, mothers age, start of prenatal care and race.</p>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>